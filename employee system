
2. Consider the Employce database, which consists of the following tables where the
primary keys are underlined.
employee (EmployeelD, EmployeeName, Street, City)
works (EmployeeID, CompanyName, Salary)
company (CompanyName, City)
manages (EmployeelD, ManagerlD)
Write SQL queries for the following requirements.
1 Find the company that has the most employees.
11. Find employees who do not have a manager.
HL Find the second highest salary among employees.
IV. find all employees who live in Dhaka city, but their company is not in Dhaka.

1:
SELECT CompanyName
FROM works
GROUP BY CompanyName
ORDER BY COUNT(EmployeeID) DESC
LIMIT 1;

2:
SELECT E.EmployeeID, E.EmployeeName
FROM employee E
WHERE E.EmployeeID NOT IN (SELECT EmployeeID FROM manages);
3:
SELECT MAX(Salary) AS SecondHighest
FROM works
WHERE Salary < (SELECT MAX(Salary) FROM works);
4:
SELECT E.EmployeeID, E.EmployeeName
FROM employee E
JOIN works W ON E.EmployeeID = W.EmployeeID
JOIN company C ON W.CompanyName = C.CompanyName
WHERE E.City = 'Dhaka' AND C.City <> 'Dhaka';


5. Consider the Employee database, which consists of the following tables where the
primary keys are underlined.
employee (EmployeeID, EmployeeName, Street, City)
works (EmploveeID, CompanyName, Salary)
company (CompanyName, City)
manages (EmployeeID, ManagerID)
Write SQL queries for the following requirements.
1. Find companies with more than 5 employees.
II. Give all employees of First Bank Corporation a 20% salary raise.
III. Delete all records where an employee has no manager.
IV. Assign a new manager to employees who currently have no manager.

//solutions 

1:
SELECT CompanyName, COUNT(EmployeeID) AS EmployeeCount
FROM works
GROUP BY CompanyName
HAVING COUNT(EmployeeID) > 5;

2:
UPDATE works
SET Salary = Salary * 1.20
WHERE CompanyName = 'First Bank Corporation';

3:
DELETE FROM manages
WHERE ManagerID IS NULL;
4:
UPDATE manages
SET ManagerID = 100
WHERE ManagerID IS NULL;
